<!DOCTYPE html>
<html>
<head>
    <title>Firestore Permissions Debug</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
</head>
<body>
    <h1>Firestore Permissions Debug</h1>
    <div id="status"></div>
    <button onclick="testAccess()">Test Access</button>
    <button onclick="signIn()">Sign In</button>
    <button onclick="signOut()">Sign Out</button>
    
    <script>
        // Replace with your actual config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "iyf-orlando-academy",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        function updateStatus(message) {
            document.getElementById('status').innerHTML += '<p>' + message + '</p>';
        }
        
        function signIn() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider).then((result) => {
                updateStatus('Signed in as: ' + result.user.email);
            }).catch((error) => {
                updateStatus('Sign in error: ' + error.message);
            });
        }
        
        function signOut() {
            auth.signOut().then(() => {
                updateStatus('Signed out');
            });
        }
        
        async function testAccess() {
            updateStatus('Testing Firestore access...');
            
            const collections = ['volunteer_applications', 'events', 'volunteer_hours', 'settings'];
            
            for (const collectionName of collections) {
                try {
                    const snapshot = await db.collection(collectionName).get();
                    updateStatus('✅ ' + collectionName + ': ' + snapshot.size + ' documents');
                } catch (error) {
                    updateStatus('❌ ' + collectionName + ': ' + error.message);
                }
            }
        }
        
        auth.onAuthStateChanged((user) => {
            if (user) {
                updateStatus('Current user: ' + user.email);
            } else {
                updateStatus('No user signed in');
            }
        });
    </script>
</body>
</html>
